# Repository guidelines

This repository manages a home lab environment with **Packer**, **Terraform** and **Ansible**. The project generates RHEL images, provisions VMs with Terraform and configures them using Ansible playbooks.

## Recommended tooling

- [Packer](https://www.packer.io/) to build images (`packer/README.md` describes how to build)
- [Terraform](https://www.terraform.io/) to create VMs (`terraform/README.md` describes variables and commands)
- [Ansible](https://www.ansible.com/) for configuration (`ansible/README.md` documents usage)

Development dependencies are defined in `pyproject.toml`. The `ruff` linter is available in the container.

## Working in this repo

1. **Do not commit sensitive files**
   - ISO images go into `packer/iso-files` and are gitâ€‘ignored.
   - Terraform variable files (`*.tfvars`) and Ansible vault files (`ansible/group_vars/all/vault.yml`) are ignored.
2. **Run `ruff check .` before committing** to ensure there are no Python lint errors.
3. Infrastructure files should be validated and formatted consistently.
   - **Ansible**: run `ansible-lint` and `yamllint` on playbooks.
   - **Terraform**: run `terraform fmt -recursive`.
   - **Packer**: run `packer fmt`.
   - **Kickstart**: validate `.ks` files with `ksvalidator`.
4. When editing Ansible playbooks remember that `inventory/hosts` and `ansible.cfg` are generated by Terraform.
5. For instructions on building images and provisioning VMs see the READMEs in each subdirectory.

